syntax = "proto3";

package drone;

// ROI 박스
message ROI {
  int32 x = 1;
  int32 y = 2;
  int32 w = 3;
  int32 h = 4;
}

// 키 이벤트: "r" (ROI 재지정), "q" (저장 후 종료)
message KeyEvent {
  string key = 1;
}

// 클라이언트 -> 서버 제어 메시지 (양방향 스트림 상행)
message Control {
  oneof control {
    ROI roi = 1;
    KeyEvent key = 2;
  }
}

// 서버 -> 클라이언트 프레임 메시지 (양방향 스트림 하행)
message Frame {
  bytes jpg = 1;      // JPEG 인코딩된 프레임
  string hint = 2;    // UI 힌트 텍스트
  string status = 3;  // 상태 메시지 (optional)
}

// 서비스: 양방향 스트리밍
service DroneStream {
  rpc StreamVideo (stream Control) returns (stream Frame);
}

